:root{--ui-font: -apple-system, "SF Pro Text", "SF Pro Icons", "Helvetica Neue", Helvetica, Arial, "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", sans-serif;--ui-font-display: -apple-system, "SF Pro Display", "SF Pro Icons", "Helvetica Neue", Helvetica, Arial, "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", sans-serif;--system-blue: #007AFF;--gold-base: #f9b233;--gold-bright: #ffcc5c;--gold-shadow: rgba(249, 178, 51, .35);--system-green: #34C759;--system-indigo: #5856D6;--system-orange: #FF9500;--system-pink: #FF2D55;--system-purple: #AF52DE;--system-red: #FF3B30;--system-teal: #5AC8FA;--system-yellow: #FFCC00;--system-gray: #8E8E93;--system-gray2: #AEAEB2;--system-gray3: #C7C7CC;--system-gray4: #D1D1D6;--system-gray5: #E5E5EA;--system-gray6: #F2F2F7;--ui-bg-base: #FFFFFF;--ui-bg-secondary: #F2F2F7;--ui-text-primary: #000000;--ui-text-secondary: #8E8E93;--ui-text-tertiary: #C7C7CC;--ui-separator: #C6C6C8;--ui-accent: var(--gold-base);--ui-accent-gradient: linear-gradient(145deg, var(--gold-bright), var(--gold-base));--ui-accent-highlight: rgba(249, 178, 51, .18);--material-ultra-thin: rgba(255, 255, 255, .48);--material-thin: rgba(255, 255, 255, .7);--material-regular: rgba(255, 255, 255, .82);--material-thick: rgba(255, 255, 255, .94);--glass-border: rgba(255, 255, 255, .2);--glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, .15);--glass-highlight: rgba(255, 255, 255, .45);--ui-bg-gradient: radial-gradient(120% 120% at 20% 20%, rgba(0, 122, 255, .16) 0%, rgba(0, 122, 255, 0) 50%), radial-gradient(120% 120% at 80% 0%, rgba(255, 45, 85, .12) 0%, rgba(255, 45, 85, 0) 45%), linear-gradient(135deg, #f6f7fb 0%, #d9e1f2 50%, #f5f7fa 100%);--ui-aurora-1: rgba(0, 122, 255, .16);--ui-aurora-2: rgba(255, 45, 85, .12);--radius-xs: 8px;--radius-sm: 12px;--radius-md: 18px;--radius-lg: 24px;--radius-xl: 32px;--radius-pill: 9999px;--ui-space-1: 4px;--ui-space-2: 8px;--ui-space-3: 12px;--ui-space-4: 16px;--ui-space-5: 24px;--ui-space-6: 32px;--ui-layout-view-padding: var(--ui-space-4);--ui-layout-view-gap: var(--ui-space-3);--ui-layout-game-view-padding-top: var(--ui-space-2);--ui-layout-game-container-gap: var(--ui-space-2);--ui-layout-game-container-padding-top: var(--ui-space-3);--ui-layout-game-container-padding-bottom: var(--ui-space-5);--ui-layout-game-header-gap: var(--ui-space-3);--ui-layout-game-header-padding-y: var(--ui-space-3);--ui-layout-game-header-padding-x: var(--ui-space-4);--ui-layout-game-stage-top: var(--ui-space-2);--ui-layout-game-stage-bottom: 72px;--shadow-sm: 0 2px 8px rgba(0, 0, 0, .04);--shadow-md: 0 8px 24px rgba(0, 0, 0, .08);--shadow-lg: 0 16px 48px rgba(0, 0, 0, .12);--motion-fast: .15s;--motion-medium: .26s;--motion-slow: .48s}body.dark-mode{--ui-bg-base: #000000;--ui-bg-secondary: #1C1C1E;--ui-text-primary: #FFFFFF;--ui-text-secondary: #8E8E93;--ui-text-tertiary: #48484A;--ui-separator: #38383A;--ui-bg-gradient: linear-gradient(135deg, #000000 0%, #1C1C1E 100%);--ui-aurora-1: rgba(90, 200, 250, .14);--ui-aurora-2: rgba(175, 82, 222, .12);--material-ultra-thin: rgba(30, 30, 30, .48);--material-thin: rgba(30, 30, 30, .7);--material-regular: rgba(30, 30, 30, .82);--material-thick: rgba(28, 28, 30, .94);--glass-border: rgba(255, 255, 255, .15);--glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, .5)}button{all:unset;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box}.glass-panel{background:var(--material-regular);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid var(--glass-border);box-shadow:0 16px 40px #0000001a,inset 0 1px 0 var(--glass-highlight);border-radius:var(--radius-lg);color:var(--ui-text-primary)}.glass-pill{background:var(--material-thin);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid var(--glass-border);border-radius:var(--radius-pill);box-shadow:var(--shadow-sm)}.ui-button,button{font-family:var(--ui-font);font-weight:600;font-size:15px;height:44px;padding:0 24px;border-radius:var(--radius-pill);background:var(--ui-accent-gradient);color:#fff;border:none;box-shadow:0 8px 22px var(--gold-shadow, rgba(249, 178, 51, .24));transition:transform var(--motion-fast) ease,opacity var(--motion-fast) ease,box-shadow var(--motion-medium) ease;cursor:pointer}.ui-button:hover,button:hover{box-shadow:0 12px 28px var(--gold-shadow, rgba(249, 178, 51, .32));transform:translateY(-1px)}.ui-button:active,button:active{transform:scale(.97);opacity:.9;box-shadow:0 6px 16px var(--gold-shadow, rgba(249, 178, 51, .24))}.ui-button.primary{background:var(--ui-accent-gradient)}.ui-button.gold{background:linear-gradient(145deg,#ffcc5c,#f9b233);color:#1d1b16;box-shadow:0 10px 26px #00000059,0 0 18px #ffcc5c59}.ui-button.gold:hover{box-shadow:0 12px 30px #00000061,0 0 20px #ffcc5c66}.ui-button.gold:active{transform:scale(.98);box-shadow:0 8px 20px #0000004d,inset 0 2px 4px #fff3}.ui-button.secondary,button.secondary{background:var(--material-thin);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);color:var(--ui-text-primary);border:1px solid var(--glass-border);box-shadow:var(--shadow-sm)}.ui-button.small,button.small{height:36px;padding:0 16px;font-size:14px}.ui-button.icon-only,button.icon-only{width:44px;padding:0;border-radius:50%}.ui-button.mini{width:44px;height:44px;min-width:44px;padding:0;border-radius:50%;aspect-ratio:1 / 1;display:inline-flex;align-items:center;justify-content:center;font-size:18px;box-shadow:inset 0 1px #fff6,0 6px 16px #0000002e}.ui-button.mini.secondary{background:var(--material-thin);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);color:var(--ui-text-primary);border:1px solid var(--glass-border);box-shadow:var(--shadow-sm)}.ui-button.mini.secondary:hover{background:#ffffff2e}.ui-button.mini.secondary:active{transform:scale(.97)}.dark-mode .ui-button.mini.secondary{background:var(--material-thin);border-color:#ffffff2e;color:#ebeef4e6}button:focus-visible,.ui-button:focus-visible{outline:2px solid var(--ui-accent);outline-offset:2px}.ui-title{font-family:var(--ui-font-display);font-weight:700;letter-spacing:.01em;color:var(--ui-text-primary)}.ui-caption{font-family:var(--ui-font);font-size:12px;color:var(--ui-text-secondary);font-weight:500}.ui-list{display:flex;flex-direction:column;background:var(--material-regular);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-radius:var(--radius-lg);padding:0;margin:0;overflow:hidden}.ui-list-item{display:flex;align-items:center;justify-content:space-between;padding:16px;border-bottom:1px solid var(--ui-separator)}.ui-list-item:last-child{border-bottom:none}input[type=text],input[type=number]{height:36px;background:var(--system-gray6);border:none;border-radius:8px;padding:0 12px;font-size:17px;color:var(--ui-text-primary);width:100%}input:focus{outline:2px solid var(--ui-accent);background:var(--ui-bg-base)}.ui-toggle{position:relative;display:inline-block;width:51px;height:31px}.ui-toggle input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:var(--system-gray5);transition:.4s;border-radius:31px}.slider:before{position:absolute;content:"";height:27px;width:27px;left:2px;bottom:2px;background-color:#fff;transition:.4s;border-radius:50%;box-shadow:0 2px 4px #0003}input:checked+.slider{background-color:var(--ui-accent)}input:checked+.slider:before{transform:translate(20px)}.overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:#0006;backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);z-index:2000;display:flex;align-items:center;justify-content:center;opacity:1;transition:opacity .3s ease}.overlay.hidden{opacity:0;pointer-events:none;display:none}.overlay-content{width:90%;max-width:400px;max-height:80vh;overflow-y:auto;padding:var(--ui-space-5);display:flex;flex-direction:column;gap:var(--ui-space-4);animation:scale-up .3s cubic-bezier(.175,.885,.32,1.275)}.overlay-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--ui-space-2)}.leaderboard-form{display:flex;gap:var(--ui-space-2)}.overlay-actions{display:flex;justify-content:flex-end;gap:var(--ui-space-2)}.leaderboard-entry{display:grid;gap:var(--ui-space-2);padding:var(--ui-space-3);border-radius:var(--radius-md);border:1px solid var(--glass-border);background:var(--material-thin)}.leaderboard-status{padding:var(--ui-space-2) var(--ui-space-3);border-radius:var(--radius-md);border:1px solid var(--glass-border);background:var(--material-ultra-thin);color:var(--ui-text-primary);box-shadow:var(--shadow-sm);font-weight:600}.leaderboard-status.ok{color:var(--system-green)}.leaderboard-status.error{color:var(--system-red)}.leaderboard-list{display:flex;flex-direction:column;gap:var(--ui-space-3);padding:var(--ui-space-3);max-height:52vh;overflow-y:auto;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;padding-right:var(--ui-space-1);scrollbar-width:none;-ms-overflow-style:none;background:#ffffffc7;border:1px solid rgba(0,0,0,.04);box-shadow:inset 0 1px #fff6,0 10px 24px #0000002e;border-radius:20px}.leaderboard-list::-webkit-scrollbar{display:none}.leaderboard-list .ui-list-item{list-style:none}.leaderboard-hero{color:#f7c948;font-weight:800;line-height:1;margin:var(--ui-space-2) 0 var(--ui-space-3)}.leaderboard-input{background:var(--material-thin);color:var(--ui-text-primary);border:1px solid var(--glass-border);box-shadow:inset 0 1px 0 var(--glass-highlight)}.dark-mode .leaderboard-input{background:#1e1e22e6;color:#ebeef4eb;border-color:#ffffff0f}.leaderboard-input::placeholder{color:#00000073}.dark-mode .leaderboard-input::placeholder{color:#fff9}.leader-card{display:flex;justify-content:space-between;align-items:center;gap:var(--ui-space-4);padding:var(--ui-space-3);border-radius:16px;background:#ffffffdb;border:1px solid rgba(0,0,0,.04);box-shadow:inset 0 1px #ffffff80,0 8px 18px #0000001f;position:relative}.dark-mode .leader-card{background:#1c1c20cc;border:1px solid rgba(255,255,255,.05);box-shadow:inset 0 1px #ffffff0d,0 10px 20px #00000047}.leader-card .lb-left{display:flex;align-items:center;gap:var(--ui-space-3);min-width:0;flex:1 1 50%}.leader-card .lb-rank{width:36px;height:36px;min-width:36px;border-radius:12px;background:#0000000f;display:inline-flex;align-items:center;justify-content:center;font-weight:800;color:#2b2b2b}.dark-mode .leader-card .lb-rank{background:#ffffff14;color:#f0f2f7e6}.leader-card .lb-rank.gold{color:#f7c948;background:#f7c94826}.leader-card .lb-rank.silver{color:#556473;background:#c8d2dc1f}.leader-card .lb-rank.bronze{color:#b26f3c;background:#d7955b1f}.leader-card .lb-player{display:flex;flex-direction:column;gap:var(--ui-space-1);flex:1;min-width:0}.leader-card .lb-name{font-weight:700;white-space:normal;overflow:hidden;text-overflow:ellipsis}.leader-card .lb-date{opacity:.75}.leader-card .lb-right{display:flex;align-items:center;gap:var(--ui-space-3);flex:0 0 auto}.leader-card .lb-stat{display:flex;flex-direction:column;align-items:flex-end;gap:var(--ui-space-1);min-width:52px}.leader-card .lb-stat-label{font-size:11px;opacity:.75}.leader-card .lb-stat-value{font-weight:700}.leader-card .lb-score{font-weight:800;font-size:18px;min-width:76px;text-align:right}.leader-card .lb-stat-stack{display:flex;flex-direction:column;gap:var(--ui-space-1)}.level-list{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:var(--ui-space-4);width:100%}.level-card{display:flex;flex-direction:column;align-items:stretch;gap:0;padding:0;border-radius:var(--radius-lg);border:1px solid var(--glass-border);background:var(--material-regular);box-shadow:var(--shadow-md);text-align:center;cursor:pointer;transition:transform var(--motion-fast) ease,box-shadow var(--motion-medium) ease,border-color var(--motion-fast) ease;overflow:hidden}.level-card:hover{transform:translateY(-1px);box-shadow:var(--shadow-lg)}.level-card:active{transform:scale(.99)}.level-card:focus-visible{outline:2px solid var(--ui-accent);outline-offset:2px}.level-card:disabled,.level-card.locked{opacity:.5;cursor:not-allowed;transform:none;box-shadow:var(--shadow-sm)}.level-card.current{border-color:var(--ui-accent);box-shadow:0 10px 26px #0003,0 0 0 1px var(--ui-accent-highlight)}.level-card-soon{background:var(--material-thin);border-style:dashed;cursor:default}.level-preview{width:100%;height:clamp(130px,18vh,180px);overflow:hidden;background:var(--material-thin);display:flex;align-items:center;justify-content:center}.level-preview img{width:100%;height:100%;object-fit:cover;display:block}.level-preview-soon{background:linear-gradient(135deg,#fff3,#fff0),radial-gradient(80% 80% at 20% 20%,rgba(255,204,92,.2),transparent 60%);color:var(--ui-text-secondary);font-weight:700;font-size:16px}.level-card-body{display:flex;flex-direction:column;flex:1;gap:var(--ui-space-2);padding:var(--ui-space-3) var(--ui-space-4) var(--ui-space-4)}.level-card-header{display:flex;flex-direction:column;align-items:center;gap:var(--ui-space-1)}.level-title{font-family:var(--ui-font-display);font-weight:800;font-size:18px;color:var(--ui-text-primary);line-height:1.2}.level-status{display:inline-flex;align-items:center;justify-content:center;padding:4px 10px;border-radius:var(--radius-pill);font-size:12px;font-weight:700;background:var(--material-thin);border:1px solid var(--glass-border);color:var(--ui-text-secondary)}.level-status.unlocked{color:var(--system-green)}.level-status.locked{color:var(--system-gray)}.level-status.current{color:var(--ui-accent)}.level-status.soon{color:var(--system-orange)}.level-meta{font-size:14px;color:var(--ui-text-secondary)}.level-card-actions{display:flex;justify-content:center;margin-top:auto;padding-top:var(--ui-space-2)}.level-card-actions .ui-button{pointer-events:none;min-width:120px}@media(max-width:720px){.level-list{grid-template-columns:1fr}}.overlay-centered .overlay-header{justify-content:center;position:relative;width:100%}.overlay-centered .overlay-close{position:absolute;right:0;top:50%;transform:translateY(-50%)}.overlay-centered .overlay-title,.overlay-centered .overlay-subtitle,.overlay-centered .overlay-entry,.overlay-centered .overlay-hero{text-align:center;width:100%}.overlay-centered .overlay-actions{justify-content:center;width:100%}.overlay-centered .overlay-form{justify-content:center}@keyframes scale-up{0%{transform:scale(.9);opacity:0}to{transform:scale(1);opacity:1}}@media(prefers-reduced-motion:reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}.text-hero{font-family:var(--ui-font-display);font-weight:800;font-size:34px;letter-spacing:-.01em}.text-body{font-size:17px;line-height:1.4;color:var(--ui-text-primary)}.text-body-sm{font-size:15px;line-height:1.4;color:var(--ui-text-secondary)}.dark-mode .leaderboard-list{background:#141416d1;border:1px solid rgba(255,255,255,.05);box-shadow:inset 0 1px #ffffff0a,0 12px 26px #00000059}html,body{background:var(--ui-bg-gradient);color:var(--ui-text-primary);margin:0;padding:0;height:100%;width:100%;overflow:hidden;font-family:var(--ui-font);position:relative;overscroll-behavior:none;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;user-select:none;-webkit-user-select:none;-ms-user-select:none}*,*:before,*:after{box-sizing:border-box}input,textarea,[contenteditable=true]{user-select:text;-webkit-user-select:text;-ms-user-select:text}body:before,body:after{content:"";position:fixed;top:0;right:0;bottom:0;left:0;pointer-events:none;background:radial-gradient(50% 50% at 20% 20%,var(--ui-aurora-1),transparent 50%),radial-gradient(45% 45% at 80% 0%,var(--ui-aurora-2),transparent 55%);filter:blur(50px);opacity:.8;z-index:0;animation:drift var(--motion-slow) ease-in-out infinite alternate}.app-shell{height:100%;display:flex;flex-direction:column;position:relative;z-index:1}.app-main{flex:1;overflow-y:auto;overflow-x:hidden;padding:24px 0 120px;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;height:100%}body[data-view="2048"] .app-main{overflow:hidden;padding:0}body[data-view="2048"] #view-2048.view{height:100%}body[data-view=city] .bottom-nav{display:none!important}.bottom-nav{display:none;position:fixed;bottom:24px;bottom:calc(24px + env(safe-area-inset-bottom));left:50%;transform:translate(-50%);width:min(400px,90vw);height:64px;background:linear-gradient(145deg,#fffc,#ffffffad);backdrop-filter:blur(35px) saturate(180%);-webkit-backdrop-filter:blur(35px) saturate(180%);border:1px solid var(--glass-border);box-shadow:0 12px 32px #00000024,inset 0 1px #fff9;border-radius:var(--radius-pill);display:flex;justify-content:space-around;align-items:center;padding:0 16px;z-index:1000;box-sizing:border-box;transition:transform var(--motion-medium) ease,box-shadow var(--motion-medium) ease,background var(--motion-medium) ease;animation:float var(--motion-slow) ease-in-out infinite alternate}.dark-mode .bottom-nav{background:radial-gradient(120% 120% at 20% 20%,rgba(255,255,255,.05),transparent 55%),radial-gradient(120% 120% at 80% 0%,rgba(0,0,0,.35),transparent 60%),linear-gradient(145deg,#18181ce6,#101014eb);box-shadow:0 16px 36px #0006,inset 0 1px #ffffff0a;border-color:#ffffff14}.nav-button{background:transparent;color:var(--ui-text-secondary);display:flex;flex-direction:column;align-items:center;gap:2px;font-size:10px;font-weight:600;padding:4px;transition:all .2s ease;opacity:.5;width:66px;cursor:pointer;border-radius:var(--radius-pill)}.dark-mode .nav-button{color:#e0e4ecc7}.nav-button.active{color:var(--ui-accent);opacity:1;transform:translateY(-2px);text-shadow:0 0 8px var(--ui-accent-highlight);background:var(--ui-accent-highlight);box-shadow:inset 0 1px #fff6,0 8px 16px #0000001f}.nav-button span{transition:color .18s ease}.nav-button.active span{color:var(--ui-accent)}.nav-button svg{width:22px;height:22px}.view{width:100%;display:flex;flex-direction:column;padding:var(--ui-layout-view-padding);box-sizing:border-box;max-width:1200px;gap:var(--ui-layout-view-gap);align-items:center;margin:0 auto}.view-header{padding-bottom:16px;display:flex;justify-content:space-between;align-items:flex-end;gap:12px}.view-header h2{font-size:34px;font-weight:800;margin:0;color:var(--ui-text-primary);line-height:1}.view-subtitle{font-size:16px;color:var(--ui-text-secondary);margin-top:4px}#view-city{height:100%;display:flex;flex-direction:column;padding:0;position:relative}#city-root{flex:1;width:100%;position:absolute;top:0;right:0;bottom:0;left:0;overflow:hidden;background:linear-gradient(180deg,#87ceeb,#98fb98,#90ee90)}.city-top-bar{position:absolute;top:0;left:0;right:0;display:flex;justify-content:space-between;align-items:center;padding:16px 20px;padding-top:calc(16px + env(safe-area-inset-top));z-index:200;pointer-events:none}.city-top-bar>*{pointer-events:auto}.city-coins-display{display:flex;align-items:center;gap:8px;background:#ffffffe6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:8px 16px;border-radius:20px;box-shadow:0 4px 20px #00000026;font-weight:700;font-size:1rem}.city-coin-icon{font-size:1.2rem}.city-settings-btn{width:44px;height:44px;border:none;background:#ffffffe6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:50%;font-size:1.3rem;cursor:pointer;box-shadow:0 4px 20px #00000026;transition:transform .2s}.city-settings-btn:hover{transform:scale(1.1)}.city-floating-actions{position:absolute;bottom:calc(20px + env(safe-area-inset-bottom));left:0;right:0;display:flex;justify-content:space-between;padding:0 16px;z-index:200;pointer-events:none}.city-floating-actions.hidden{display:none}.city-fab-group{display:flex;gap:10px;pointer-events:auto}.city-fab{display:flex;flex-direction:column;align-items:center;justify-content:center;width:64px;height:64px;border:none;border-radius:18px;cursor:pointer;transition:all .2s;box-shadow:0 6px 25px #00000040}.city-fab-edit{background:linear-gradient(135deg,#ff6b9d,#c9a0dc);color:#fff}.city-fab-shop{background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#fff}.city-fab-wardrobe{background:linear-gradient(135deg,#c084fc,#a855f7);color:#fff}.city-fab-play{background:linear-gradient(135deg,#4ade80,#22c55e);color:#fff}.city-fab:hover{transform:translateY(-4px);box-shadow:0 10px 35px #0000004d}.city-fab:active{transform:translateY(-2px)}.city-fab-icon{font-size:1.4rem;line-height:1}.city-fab-label{font-size:.65rem;font-weight:700;text-transform:uppercase;letter-spacing:.3px;margin-top:3px}.city-edit-panel{position:absolute;bottom:calc(88px + env(safe-area-inset-bottom));left:0;right:0;background:#2a1f4ef2;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-top-left-radius:24px;border-top-right-radius:24px;padding:16px 20px;z-index:300;transform:translateY(100%);transition:transform .3s ease}.city-edit-panel:not(.hidden){transform:translateY(0)}.city-edit-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.city-edit-header h3{margin:0;color:#ffb6c1;font-size:1.1rem}.city-edit-close{width:32px;height:32px;border:none;background:#ffffff1a;border-radius:50%;color:#fff;font-size:1.3rem;cursor:pointer;transition:background .2s}.city-edit-close:hover{background:#fff3}.city-edit-tools{display:flex;gap:8px;margin-bottom:12px}.city-edit-tools .city-mode{flex:1}.city-palette{height:100px;display:flex;gap:10px;overflow-x:auto;padding:8px 0;align-items:center}.city-edit-actions{display:flex;gap:8px;margin-top:12px;justify-content:flex-end}.city-item{flex:0 0 80px;height:80px;background:var(--ui-bg-base);border:1px solid var(--ui-separator);border-radius:14px;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:6px;position:relative;transition:all .2s cubic-bezier(.4,0,.2,1);box-shadow:var(--shadow-sm)}.city-item.active{border-color:var(--ui-accent);background:var(--ui-bg-base);transform:scale(1.05);box-shadow:0 8px 20px #0000001a;z-index:2}.city-item.locked{opacity:.4;filter:grayscale(1)}.city-item-preview{width:32px;height:32px;background-size:contain;background-repeat:no-repeat;background-position:center;margin-bottom:4px}.city-item-name{font-size:10px;font-weight:600;max-width:70px;text-align:center}.city-item-count{position:absolute;top:-6px;right:-6px;font-size:10px;background:var(--ui-text-primary);color:var(--ui-bg-base);padding:2px 6px;border-radius:10px;font-weight:700;border:2px solid var(--ui-bg-base)}.city-hint{position:absolute;bottom:220px;left:50%;transform:translate(-50%);padding:8px 16px;font-size:13px;font-weight:600;pointer-events:none;z-index:10;color:var(--ui-text-primary)}.shop-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px;width:100%;max-width:1200px;margin:0 auto}.shop-item{background:var(--material-regular);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-radius:var(--radius-lg);padding:20px;box-shadow:var(--shadow-md);border:1px solid var(--glass-border);display:flex;flex-direction:column;gap:12px}.shop-title{margin:0;font-size:20px;font-weight:600}.settings-button{position:fixed;right:20px;bottom:calc(100px + env(safe-area-inset-bottom));width:46px;height:46px;border-radius:50%;border:1px solid var(--glass-border);background:var(--material-regular);color:var(--ui-text-primary);box-shadow:var(--shadow-md);display:inline-flex;align-items:center;justify-content:center;font-size:20px;cursor:pointer;z-index:2000;transition:transform var(--motion-fast) ease,box-shadow var(--motion-medium) ease,background var(--motion-medium) ease}.settings-button:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}.settings-button:active{transform:scale(.96)}.dark-mode .settings-button{background:#1e1e22e6;color:#e6e8eee6;box-shadow:0 14px 28px #00000059,inset 0 1px #ffffff0d}.settings-panel{max-width:420px;width:92vw}.settings-row{display:flex;align-items:center;justify-content:space-between;gap:var(--ui-space-3);padding:var(--ui-space-3);border:1px solid var(--glass-border);border-radius:var(--radius-md);background:var(--material-thin);box-shadow:var(--shadow-sm)}.settings-title{font-size:16px}.settings-stack{display:flex;flex-direction:column;gap:var(--ui-space-1)}.settings-row.settings-row-column{flex-direction:column;align-items:flex-start;gap:var(--ui-space-3)}.settings-button-row{display:flex;gap:var(--ui-space-2);flex-wrap:wrap}@media(max-width:768px){.settings-button{bottom:calc(88px + env(safe-area-inset-bottom));right:16px}}.hidden{display:none!important}#leaderboard{--gold-glow: rgba(255, 214, 120, .22)}#leaderboard .glass-panel{background:radial-gradient(80% 60% at 50% 0%,rgba(255,214,120,.08),transparent 70%),var(--material-regular);box-shadow:0 20px 50px #00000059,0 0 0 1px #ffffff0d,0 12px 32px var(--gold-glow)}#level-select .overlay-content{max-width:min(900px,94vw)}@keyframes float{0%{transform:translate(-50%)}to{transform:translate(-50%,-4px)}}@keyframes drift{0%{transform:translateZ(0) scale(1)}to{transform:translate3d(-10px,8px,0) scale(1.03)}}@media(max-width:768px){.bottom-nav{width:94vw;height:60px}.view-header h2{font-size:28px}.view-header{align-items:flex-start}.app-main{padding:12px 0 100px}.view{padding:12px 10px}}.app-main::-webkit-scrollbar{display:none}.app-main{-ms-overflow-style:none;scrollbar-width:none}#view-2048.view{padding:var(--ui-layout-game-view-padding-top) 0 0;max-width:100%;width:100%;align-items:center;overflow-x:hidden;flex:1}.container{--board-span: clamp(340px, min(96vw, 70vh), 660px);width:100%;height:auto;max-width:100%;flex:1;margin:0 auto;display:flex;flex-direction:column;align-items:center;gap:var(--ui-layout-game-container-gap);padding:var(--ui-layout-game-container-padding-top) 0 var(--ui-layout-game-container-padding-bottom)}.game-stage{display:flex;align-items:flex-start;justify-content:center;flex:1;width:100%;padding-top:var(--ui-layout-game-stage-top);padding-bottom:calc(var(--ui-layout-game-stage-bottom) + env(safe-area-inset-bottom));touch-action:none}.game-container{--field-base: var(--board-span);--field-width: min(var(--field-base), 96vw);--grid-spacing: calc(var(--field-width) * .025);--grid-row-cells: 4;--tile-size: calc((var(--field-width) - (var(--grid-spacing) * (var(--grid-row-cells) + 1))) / var(--grid-row-cells));--tile-radius: calc(var(--tile-size) * .1);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-touch-callout:none;margin:0 auto;width:var(--field-width);max-width:var(--field-width);height:var(--field-width);position:relative;padding:0;box-sizing:border-box;touch-action:none;overflow:hidden;background:linear-gradient(160deg,#ffffffe6,#ffffffd1);border-radius:16px;box-shadow:0 18px 48px #0000001f,inset 0 1px #ffffff8c}.dark-mode .game-container{background:linear-gradient(160deg,#18181ceb,#101012e0);box-shadow:0 18px 48px #00000059,inset 0 1px #ffffff0f}header{display:grid;grid-template-columns:1fr auto;gap:var(--ui-layout-game-header-gap);width:100%;max-width:min(900px,94vw,var(--board-span));padding:var(--ui-layout-game-header-padding-y) var(--ui-layout-game-header-padding-x)}.header-top-row{display:flex;align-items:center;justify-content:space-between;width:100%;gap:12px;margin-bottom:8px}.header-top-row .title-stack{flex:1;align-items:center}.back-btn{flex-shrink:0}.title-stack{display:flex;flex-direction:column;gap:var(--ui-space-2);align-items:flex-start}h1{font-family:var(--ui-font-display);font-size:34px;font-weight:800;margin:0;line-height:1;color:var(--ui-text-primary);align-self:center}.level-badge{font-size:12px;font-weight:700;color:var(--ui-text-secondary);padding:4px 10px;align-self:flex-start}.scores{display:flex;gap:8px;justify-content:flex-end;align-items:center;flex-wrap:wrap;row-gap:6px}.header-buttons{grid-column:1 / -1;display:flex;align-items:center;gap:10px;width:100%;margin-top:4px}.header-buttons .ui-button{width:auto}.header-buttons .ui-button:not(.mini){min-width:110px}.header-spacer{flex:1}.score-container,.best-container,.currency-container{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;min-width:96px;min-height:50px;padding:6px 10px;line-height:1.1;flex:1;position:relative}.score-label{font-size:12px;font-weight:700;color:var(--ui-text-secondary);letter-spacing:.01em;line-height:1.1}.score-value{font-size:18px;font-weight:800;color:var(--ui-text-primary);line-height:1.1}.game-container:before{content:"";position:absolute;top:0;right:0;bottom:0;left:0;background:radial-gradient(120% 120% at 20% 20%,rgba(0,122,255,.1),transparent 60%),radial-gradient(120% 120% at 80% 0%,rgba(255,45,85,.08),transparent 55%);pointer-events:none;z-index:1}.pixi-board{width:100%;height:100%;display:block;pointer-events:none}.game-message{display:none;position:absolute;top:0;right:0;bottom:0;left:0;background:var(--material-thick);backdrop-filter:blur(25px) saturate(180%);-webkit-backdrop-filter:blur(25px) saturate(180%);z-index:100;flex-direction:column;align-items:center;justify-content:center;text-align:center;border-radius:16px;padding:24px;animation:fade-in .3s ease}.game-message.game-won,.game-message.game-over{display:flex}.game-message p{font-size:38px;font-weight:800;margin:0 0 32px;color:var(--ui-text-primary)}.game-message .ui-button{width:100%;max-width:260px;height:50px}@keyframes fade-in{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}@media(max-width:640px){header{grid-template-columns:1fr;align-items:flex-start;justify-items:center;text-align:center;max-width:100%}.title-stack{align-items:center}h1{font-size:32px}.scores{width:100%;justify-content:center}.header-buttons{display:flex;gap:8px}.game-container{--board-span: min(96vw, 70vh)}.score-container,.best-container,.currency-container{min-width:84px}}.score-addition{position:absolute;top:10px;right:10px;color:var(--ui-accent);font-size:16px;font-weight:800;opacity:0;z-index:50;pointer-events:none;animation:float-up .6s ease-out forwards}@keyframes float-up{0%{opacity:1;transform:translateY(0) scale(1)}to{opacity:0;transform:translateY(-25px) scale(1.2)}}@keyframes flash-white{0%{opacity:.6}to{opacity:0}}.game-container.undo-flash:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;background-color:#fff;z-index:100;pointer-events:none;animation:flash-white .3s ease-out forwards;border-radius:16px}body[data-view=match3] .app-main{overflow:hidden;padding:0}body[data-view=match3] #view-match3.view{height:100%}#view-match3.view{padding:var(--ui-layout-game-view-padding-top) 0 0;max-width:100%;width:100%;align-items:center;overflow:hidden;flex:1}.match3-container{--board-span: clamp(340px, min(96vw, 70vh), 660px);width:100%;height:auto;max-width:100%;flex:1;margin:0 auto;display:flex;flex-direction:column;align-items:center;gap:var(--ui-layout-game-container-gap);padding:var(--ui-layout-game-container-padding-top) 0 var(--ui-layout-game-container-padding-bottom)}.match3-header{display:grid;grid-template-columns:1fr auto;gap:var(--ui-layout-game-header-gap);width:100%;max-width:min(980px,96vw,var(--board-span));padding:var(--ui-layout-game-header-padding-y) var(--ui-layout-game-header-padding-x)}.match3-scores{flex-wrap:wrap;gap:8px}.match3-scores .score-container{min-width:84px;min-height:48px;padding:6px 8px}.match3-stage{display:flex;align-items:flex-start;justify-content:center;flex:1;width:100%;padding-top:var(--ui-layout-game-stage-top);padding-bottom:calc(var(--ui-layout-game-stage-bottom) + env(safe-area-inset-bottom));touch-action:none}.match3-board{width:var(--board-span);height:var(--board-span);border-radius:18px;position:relative;overflow:hidden;background:linear-gradient(160deg,#ffffffe0,#ffffffbd);box-shadow:0 18px 48px #0000001f,inset 0 1px #ffffff73}.dark-mode .match3-board{background:linear-gradient(160deg,#18181ceb,#101012db);box-shadow:0 18px 48px #00000059,inset 0 1px #ffffff0f}.match3-canvas{width:100%;height:100%;display:block}@media(max-width:640px){.match3-header{grid-template-columns:1fr;align-items:flex-start;justify-items:center;text-align:center;max-width:100%}.match3-scores{width:100%;justify-content:center}}.character-creator-overlay{position:fixed;top:0;right:0;bottom:0;left:0;z-index:9999;display:flex;align-items:center;justify-content:center;background:#000000b3;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transition:opacity .3s ease}.character-creator-overlay.visible{opacity:1}.character-creator{width:90%;max-width:480px;max-height:90vh;overflow-y:auto;background:linear-gradient(135deg,#2a1f4e,#1a1333,#2a1f4e);border-radius:24px;border:3px solid #c9a0dc;box-shadow:0 0 40px #c9a0dc4d,0 20px 60px #00000080,inset 0 1px #ffffff1a;transform:scale(.9) translateY(20px);transition:transform .3s ease}.character-creator-overlay.visible .character-creator{transform:scale(1) translateY(0)}.cc-header{display:flex;align-items:center;justify-content:center;position:relative;padding:20px;border-bottom:2px solid rgba(201,160,220,.3);background:linear-gradient(180deg,rgba(255,182,193,.2) 0%,transparent 100%)}.cc-header h2{margin:0;font-family:Segoe UI,system-ui,sans-serif;font-size:1.5rem;font-weight:700;color:#ffb6c1;text-shadow:0 2px 10px rgba(255,182,193,.5);letter-spacing:.5px}.cc-close{position:absolute;right:16px;top:50%;transform:translateY(-50%);width:32px;height:32px;border:none;background:#ffffff1a;border-radius:50%;color:#fff;font-size:1.5rem;cursor:pointer;transition:all .2s}.cc-close:hover{background:#ff6b9d66;transform:translateY(-50%) scale(1.1)}.cc-content{display:flex;flex-direction:column;padding:20px;gap:20px}@media(min-width:500px){.cc-content{flex-direction:row}}.cc-preview{display:flex;justify-content:center;align-items:center;min-width:200px}.cc-preview-canvas{border-radius:16px;background:linear-gradient(180deg,#87ceeb,#98fb98,#90ee90);border:3px solid rgba(255,255,255,.2);box-shadow:inset 0 0 30px #fff3,0 4px 20px #0000004d}.cc-options{flex:1;display:flex;flex-direction:column;gap:16px}.cc-section{display:flex;flex-direction:column;gap:8px}.cc-label{font-family:Segoe UI,system-ui,sans-serif;font-size:.85rem;font-weight:600;color:#c9a0dc;text-transform:uppercase;letter-spacing:1px}.cc-name-input{width:100%;padding:12px 16px;border:2px solid rgba(201,160,220,.4);border-radius:12px;background:#ffffff1a;color:#fff;font-family:Segoe UI,system-ui,sans-serif;font-size:1rem;outline:none;transition:all .2s}.cc-name-input::placeholder{color:#fff6}.cc-name-input:focus{border-color:#ffb6c1;background:#ffffff26;box-shadow:0 0 15px #ffb6c14d}.cc-color-row{display:flex;gap:8px;flex-wrap:wrap}.cc-color-btn{width:36px;height:36px;border:3px solid rgba(255,255,255,.2);border-radius:50%;cursor:pointer;transition:all .2s;box-shadow:0 2px 8px #0000004d}.cc-color-btn:hover{transform:scale(1.15);border-color:#ffffff80}.cc-color-btn.active{border-color:#ffb6c1;box-shadow:0 0 15px #ffb6c180,0 2px 8px #0000004d;transform:scale(1.1)}.cc-style-row{display:flex;gap:8px;flex-wrap:wrap}.cc-style-btn{padding:8px 16px;border:2px solid rgba(201,160,220,.4);border-radius:20px;background:#ffffff1a;color:#fff;font-family:Segoe UI,system-ui,sans-serif;font-size:.85rem;cursor:pointer;transition:all .2s}.cc-style-btn:hover{background:#fff3;border-color:#c9a0dc99}.cc-style-btn.active{background:linear-gradient(135deg,#ff6b9d,#c9a0dc);border-color:transparent;box-shadow:0 4px 15px #ff6b9d66}.cc-footer{display:flex;gap:12px;justify-content:center;padding:20px;border-top:2px solid rgba(201,160,220,.3);background:linear-gradient(0deg,rgba(255,182,193,.1) 0%,transparent 100%)}.cc-btn{padding:14px 32px;border:none;border-radius:25px;font-family:Segoe UI,system-ui,sans-serif;font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s}.cc-btn-cancel{background:#ffffff1a;color:#fff;border:2px solid rgba(255,255,255,.2)}.cc-btn-cancel:hover{background:#fff3}.cc-btn-confirm{background:linear-gradient(135deg,#ff6b9d,#ff8e53);color:#fff;box-shadow:0 4px 20px #ff6b9d66}.cc-btn-confirm:hover{transform:translateY(-2px);box-shadow:0 6px 25px #ff6b9d80}.cc-btn-confirm:active{transform:translateY(0)}.character-creator:before,.character-creator:after{content:"ðŸŒ¸";position:absolute;font-size:1.5rem;opacity:.6;pointer-events:none}.character-creator:before{top:60px;left:20px}.character-creator:after{bottom:60px;right:20px}.play-menu-overlay{position:fixed;top:0;right:0;bottom:0;left:0;z-index:9998;display:flex;align-items:center;justify-content:center;background:#000000b3;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transition:opacity .3s ease}.play-menu-overlay.visible{opacity:1}.play-menu{width:90%;max-width:400px;background:linear-gradient(135deg,#1a1333,#2a1f4e,#1a1333);border-radius:24px;border:3px solid #4ade80;box-shadow:0 0 40px #4ade804d,0 20px 60px #00000080;transform:scale(.9) translateY(20px);transition:transform .3s ease;overflow:hidden}.play-menu-overlay.visible .play-menu{transform:scale(1) translateY(0)}.play-menu-header{display:flex;align-items:center;justify-content:center;position:relative;padding:20px;background:linear-gradient(180deg,rgba(74,222,128,.2) 0%,transparent 100%);border-bottom:2px solid rgba(74,222,128,.3)}.play-menu-header h2{margin:0;font-family:Segoe UI,system-ui,sans-serif;font-size:1.5rem;font-weight:700;color:#4ade80;text-shadow:0 2px 10px rgba(74,222,128,.5)}.play-menu-close{position:absolute;right:16px;top:50%;transform:translateY(-50%);width:36px;height:36px;border:none;background:#ffffff1a;border-radius:50%;color:#fff;font-size:1.5rem;cursor:pointer;transition:all .2s}.play-menu-close:hover{background:#fff3;transform:translateY(-50%) scale(1.1)}.play-menu-games{display:flex;flex-direction:column;padding:16px;gap:12px}.play-menu-game{display:flex;align-items:center;gap:16px;padding:16px;background:#ffffff0d;border:2px solid rgba(255,255,255,.1);border-radius:16px;cursor:pointer;transition:all .2s;text-align:left}.play-menu-game:hover:not(.locked){background:#4ade8026;border-color:#4ade8066;transform:translate(4px)}.play-menu-game.locked{opacity:.5;cursor:not-allowed}.play-menu-game-icon{font-size:2.5rem;width:60px;height:60px;display:flex;align-items:center;justify-content:center;background:#ffffff1a;border-radius:14px}.play-menu-game-info{flex:1}.play-menu-game-title{font-family:Segoe UI,system-ui,sans-serif;font-size:1.1rem;font-weight:700;color:#fff;margin-bottom:4px}.play-menu-game-desc{font-size:.85rem;color:#fff9}.play-menu-game-arrow{font-size:1.5rem;color:#4ade80;transition:transform .2s}.play-menu-game:hover:not(.locked) .play-menu-game-arrow{transform:translate(4px)}.play-menu-game-lock{font-size:1.2rem;opacity:.6}.wardrobe-overlay{position:fixed;top:0;right:0;bottom:0;left:0;z-index:9998;display:flex;align-items:center;justify-content:center;background:#000000b3;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transition:opacity .3s ease}.wardrobe-overlay.visible{opacity:1}.wardrobe{width:90%;max-width:420px;max-height:85vh;overflow-y:auto;background:linear-gradient(135deg,#2a1f4e,#1a1333,#2a1f4e);border-radius:24px;border:3px solid #c9a0dc;box-shadow:0 0 40px #c9a0dc4d,0 20px 60px #00000080;transform:scale(.9) translateY(20px);transition:transform .3s ease}.wardrobe-overlay.visible .wardrobe{transform:scale(1) translateY(0)}.wardrobe-header{display:flex;align-items:center;justify-content:center;position:relative;padding:16px 20px;background:linear-gradient(180deg,rgba(201,160,220,.2) 0%,transparent 100%);border-bottom:2px solid rgba(201,160,220,.3)}.wardrobe-header h2{margin:0;font-size:1.3rem;font-weight:700;color:#c9a0dc}.wardrobe-close{position:absolute;right:12px;top:50%;transform:translateY(-50%);width:32px;height:32px;border:none;background:#ffffff1a;border-radius:50%;color:#fff;font-size:1.4rem;cursor:pointer;transition:all .2s}.wardrobe-close:hover{background:#fff3}.wardrobe-content{padding:16px}.wardrobe-preview{display:flex;flex-direction:column;align-items:center;margin-bottom:16px}.wardrobe-preview-canvas{border-radius:12px;background:linear-gradient(180deg,#87ceeb,#98fb98);border:2px solid rgba(255,255,255,.2)}.wardrobe-name{margin-top:8px;font-weight:600;color:#fff;font-size:.95rem}.wardrobe-tabs{display:flex;gap:8px;margin-bottom:16px}.wardrobe-tab{flex:1;padding:10px 16px;border:2px solid rgba(201,160,220,.4);border-radius:12px;background:#ffffff0d;color:#fff;font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s}.wardrobe-tab:hover{background:#ffffff1a}.wardrobe-tab.active{background:linear-gradient(135deg,#c9a0dc,#ff6b9d);border-color:transparent}.wardrobe-panel{min-height:150px}.wardrobe-panel.hidden{display:none}.wardrobe-section{margin-bottom:14px}.wardrobe-label{display:block;font-size:.75rem;font-weight:600;color:#c9a0dc;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px}.wardrobe-color-row{display:flex;gap:8px;flex-wrap:wrap}.wardrobe-color-btn{width:32px;height:32px;border:3px solid rgba(255,255,255,.2);border-radius:50%;cursor:pointer;transition:all .2s}.wardrobe-color-btn:hover{transform:scale(1.15);border-color:#ffffff80}.wardrobe-color-btn.active{border-color:#ffb6c1;box-shadow:0 0 12px #ffb6c180;transform:scale(1.1)}.wardrobe-style-row{display:flex;gap:8px;flex-wrap:wrap}.wardrobe-style-btn{padding:8px 14px;border:2px solid rgba(201,160,220,.4);border-radius:16px;background:#ffffff1a;color:#fff;font-size:.8rem;cursor:pointer;transition:all .2s}.wardrobe-style-btn:hover{background:#fff3}.wardrobe-style-btn.active{background:linear-gradient(135deg,#ff6b9d,#c9a0dc);border-color:transparent}.wardrobe-inventory{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:120px}.wardrobe-empty{text-align:center;color:#fff9}.wardrobe-empty-icon{font-size:2.5rem;display:block;margin-bottom:8px}.wardrobe-empty p{margin:4px 0;font-size:.9rem}.wardrobe-empty-hint{font-size:.8rem!important;opacity:.7}.wardrobe-footer{padding:16px;border-top:2px solid rgba(201,160,220,.3);display:flex;justify-content:center}.wardrobe-btn{padding:12px 28px;border:none;border-radius:20px;font-size:.95rem;font-weight:600;cursor:pointer;transition:all .2s}.wardrobe-btn-save{background:linear-gradient(135deg,#ff6b9d,#ff8e53);color:#fff;box-shadow:0 4px 15px #ff6b9d66}.wardrobe-btn-save:hover{transform:translateY(-2px);box-shadow:0 6px 20px #ff6b9d80}
